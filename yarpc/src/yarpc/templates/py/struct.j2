# Generated by YARPC
# Version:  {{version}}
# Spec:
#   File: {{ object.specPath }}
#   Object: {{ object.name }}
#   Template: py/struct.j2
{% import "dbus_common.j2" as dbus %}
{% import "py/common.j2" as py %}
{% for member in object.members %}
{% if (member.type|find_type(output.objects)).kind == 'struct' %}
from .{{ member.type|snake_case }} import {{ member.type }}
{% endif %}
{% endfor %}

from dataclasses import dataclass

@dataclass
class {{ object.name }}:
    """
    {{ object.docs }}

    Args:
    {% for member in object.members %}
        {{ member.name }} ({{ py.type(member.type, output.objects) }}): {{ member.docs }}
    {% endfor %}
    """
    {% for member in object.members %}
    {{ member.name }}: {{ py.type(member.type, output.objects) }}
    {% endfor %}

    def to_dbus(self):
        """
        Marshals this object into an array compatible with dbus structs.

        Returns:
            list: the marshalled structure
        """
        return {{ py.marshal('self', object.name, output.objects)|indent(8) }}

    def from_dbus(dbus_struct: list):
        """
        Attempts to unmarshal a D-Bus struct array into this dataclass

        Args:
            dbus_struct (list): the marshalled D-Bus struct as array

        Returns:
            {{ object.name }}: the unmarshalled structure
        """
        return {{ py.unmarshal('dbus_struct', object.name, output.objects)|indent(8) }}

